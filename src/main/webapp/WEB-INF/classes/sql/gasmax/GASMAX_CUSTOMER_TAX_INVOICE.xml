<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
       PUBLIC 
             "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
              "http://ibatis.apache.org/dtd/sql-map-2.dtd"
 >
 
 <sqlMap>

     <select id="GASMAX.CustomerTaxInvoice.Select" resultClass="java.util.HashMap">
		SELECT
			  Area_Code          AS areaCode                              
			, SE_YNType          AS collectSaleType                       
			, SE_CU_Code         AS customerCode                          
			, SE_Sno             AS sequenceNumber                        
			, SE_GongNO          AS supplierRegisterNumber                
			, SE_GongSangHo      AS supplierOwnerName                     
			, SE_Date            AS issueDate                             
			, SE_NO              AS serialNumber                          
			, SE_KumType         AS invoiceType                           
			, SE_Bigo            AS remark                                
			, SE_EDI_R_Com_Type  AS registerNumberType                    
			, SE_SSNo            AS registerNumber                        
			, ISNULL(SE_EDI_R_Code, '')      AS subCompanyNumber                      
			, SE_Sangho          AS customerName                          
			, SE_Sajang          AS ownerName                             
			, SE_Addr1           AS address1                              
			, SE_Addr2           AS address2                              
			, SE_ZipCode         AS postalCode                            
			, SE_Uptae           AS businessType                          
			, SE_JongMok         AS businessItem                          
			, SE_MMDD1           AS itemDate1                             
			, SE_PMok1           AS itemName1                             
			, SE_DanW1           AS itemUnit1                             
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_QTY1, 0),1),'.00','')            AS itemQuantity1                         
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Danga1, 0),1),'.00','')          AS itemPrice1                            
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Kum1, 0),1),'.00','')            AS itemAmount1                           
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_VAT1, 0),1),'.00','')            AS itemTax1                              
			, SE_MMDD2           AS itemDate2                             
			, SE_PMok2           AS itemName2                             
			, SE_DanW2           AS itemUnit2                             
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_QTY2, 0),1),'.00','')            AS itemQuantity2                         
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Danga2, 0),1),'.00','')          AS itemPrice2                            
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Kum2, 0),1),'.00','')            AS itemAmount2                           
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_VAT2, 0),1),'.00','')            AS itemTax2                              
			, SE_MMDD3           AS itemDate3                             
			, SE_PMok3           AS itemName3                             
			, SE_DanW3           AS itemUnit3                             
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_QTY3, 0),1),'.00','')            AS itemQuantity3                         
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Danga3, 0),1),'.00','')          AS itemPrice3                            
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Kum3, 0),1),'.00','')            AS itemAmount3                           
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_VAT3, 0),1),'.00','')            AS itemTax3                              
			, SE_MMDD4           AS itemDate4                             
			, SE_PMok4           AS itemName4                             
			, SE_DanW4           AS itemUnit4                             
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_QTY4, 0),1),'.00','')            AS itemQuantity4                         
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Danga4, 0),1),'.00','')          AS itemPrice4                            
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Kum4, 0),1),'.00','')            AS itemAmount4                           
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_VAT4, 0),1),'.00','')            AS itemTax4                              
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_SumKum, 0),1),'.00','')          AS amount                                
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_SumVAT, 0),1),'.00','')          AS tax                                   
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(SE_Total, 0),1),'.00','')           AS totalAmount                           
			, Se_Turm_F          AS dataStartDate                         
			, Se_Turm_T          AS dateEndDate                           
			, SE_QTY_Print       AS quantityPricePrintYesNo               
			, SE_EDI_Doctype     AS taxInvoiceType                        
			, SE_EDI_StatusCode  AS amendReasonCode                       
			, ISNULL(SE_EDI_Serialnum, '')   AS invoiceSerialNumber                   
			, ISNULL(SE_EDI_R_a_name, '')    AS contactName                           
			, ISNULL(SE_EDI_R_a_email, '')   AS contactEmailAddress                   
			, ISNULL(SE_EDI_R_a_phone, '')   AS contactPhoneNumber                    
			, ''       AS ediStatusCode                         
			, ISNULL(SE_EDI_NAME, '')        AS ediStatusName                         
			, SE_NTS_State       AS ntsStatusCode                         
			, ISNULL(SE_NTS_NAME, '')        AS ntsStatusName                         
			, SE_NTS_ISSUE_ID    AS ntsIssueNumber                        
			, SE_EDI_Error_Msg   AS ediErrorMessage     
		FROM $catalogName$.dbo.fn_BOOK_SE_LIST('$areaCode$','$customerCode$','$startDate$','$endDate$')
		WHERE 1=1
		ORDER BY Area_Code, SE_CU_Code, SE_Date, SE_SNO
	</select>
	
</sqlMap>