<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
       PUBLIC 
             "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
              "http://ibatis.apache.org/dtd/sql-map-2.dtd"
 >
 
 <sqlMap>

     <select id="GASMAX.CustomerItemBalanceHPG.Select" resultClass="java.util.HashMap">
		SELECT
			  T1.AREA_CODE   AS areaCode
			, T1.JC_CU_CODE  AS customerCode
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(T1.JP_SORT, 0),1),'.00','')     AS sortOrder
			, T1.JC_JP_CODE  AS itemCode
			, T1.JP_Name     AS itemName
			, REPLACE(CAST(ISNULL(T1.JP_Jaego, 0) AS VARCHAR(15)),'.00','')  AS currentBalance
			, REPLACE(CAST(ISNULL(T1.QTY_PRE, 0)  AS VARCHAR(15)),'.00','')  AS preBalance
			, REPLACE(CAST(ISNULL(T1.QTY_PA, 0)   AS VARCHAR(15)),'.00','')  AS itemOutput
			, REPLACE(CAST(ISNULL(T1.QTY_RE, 0)   AS VARCHAR(15)),'.00','')  AS itemInput
			, REPLACE(CAST(ISNULL(T1.QTY_NOW, 0)  AS VARCHAR(15)),'.00','')  AS balance
			, CASE T2.CU_Danga_Code 
		          WHEN 0 THEN REPLACE(CAST(ISNULL(T2.JP_Danga_0, 0) AS VARCHAR(15)),'.00','')
		          WHEN 1 THEN REPLACE(CAST(ISNULL(T2.JP_Danga_1, 0) AS VARCHAR(15)),'.00','')
		          WHEN 2 THEN REPLACE(CAST(ISNULL(T2.JP_Danga_2, 0) AS VARCHAR(15)),'.00','')
		      END AS salePrice
		FROM $catalogName$.dbo.fn_BOOK_JAEGO_HIGH('$areaCode$','$customerCode$','$startDate$','$endDate$') T1,
		$catalogName$.dbo.fn_CUST_JP_Danga('$areaCode$','$customerCode$') T2
		 WHERE T1.JC_JP_CODE = T2.JP_CODE AND T2.JC_JP_STATE &lt;&gt; '2'
		ORDER BY T1.AREA_CODE, T1.JC_CU_CODE, T1.JP_SORT
	</select>

     <select id="GASMAX.CustomerItemBalanceLPG.Select" resultClass="java.util.HashMap">
		SELECT
			  AREA_CODE   AS areaCode
			, JC_CU_CODE  AS customerCode
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(JP_SORT, 0),1),'.00','')     AS sortOrder
			, JC_JP_CODE  AS itemCode
			, JP_Name     AS itemName
			, REPLACE(CAST(JP_Jaego AS VARCHAR(15)),'.00','') AS currentBalance
			, REPLACE(CAST(QTY_PRE AS VARCHAR(15)),'.00','')  AS preBalance
			, REPLACE(CAST(QTY_PA AS VARCHAR(15)),'.00','')   AS itemOutput
			, REPLACE(CAST(QTY_RE AS VARCHAR(15)),'.00','')   AS itemInput
			, REPLACE(CAST(ISNULL(QTY_NOW,0) AS VARCHAR(15)),'.00','')  AS balance
		FROM $catalogName$.dbo.fn_BOOK_JAEGO_LPG('$areaCode$','$customerCode$','$startDate$','$endDate$')
		WHERE 1=1
		ORDER BY AREA_CODE, JC_CU_CODE, JP_SORT
	</select>
	
</sqlMap>