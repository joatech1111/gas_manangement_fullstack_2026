<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
        PUBLIC
        "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
        "http://ibatis.apache.org/dtd/sql-map-2.dtd"
        >
<sqlMap>
    <select id="GASMAX.AppUser.Select" resultClass="java.util.HashMap">
        SELECT
        HP_Number AS macNumber
        , CAST(HP_SEQ AS VARCHAR(2)) AS areaSeq
        , HP_State AS grantState
        , HP_Model AS phoneModel
        , HP_SNO AS mobileNumber
        , SVR_IP AS ipAddress
        , SVR_DBName AS dbCatalogName
        , SVR_User AS dbUserID
        , SVR_Pass AS dbPassword
        , SVR_Port AS port
        , Login_Area AS areaCode
        , Login_Co AS areaName
        , Login_User AS userId
        , Login_Pass AS password
        , BA_Area_CODE AS lastAreaCode
        , BA_SW_CODE AS employeeCode
        , BA_SW_Name AS employeeName
        , AREA_ADDR AS areaAddress
        , AREA_DDD AS phoneAreaNumber
        , Sign_Folder AS signImagePath
        , License_Date AS licenseDate
        , Login_StartDate AS joinDate
        , Login_LastDate AS lastLoginDate
        , Login_EndDate AS expiryDate
        , APP_Cert AS menuPermission
        , Login_info AS individualNotice
        , Login_Memo AS remark
        , APP_PG_TYPE AS gasType
        FROM
        $catalogName$.dbo.AppUser
        WHERE 1=1
        <isNotEmpty prepend="AND " property="areaSeq">HP_SEQ = '$areaSeq$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="uuid">HP_Number = '$uuid$'</isNotEmpty>

    </select>

    <select id="GASMAX.AppUser.Select_userIdPwd" resultClass="java.util.HashMap">
        SELECT
        HP_Number AS macNumber,
        CAST(HP_SEQ AS VARCHAR(2)) AS areaSeq,
        HP_State AS grantState,
        HP_Model AS phoneModel,
        HP_SNO AS mobileNumber,
        SVR_IP AS ipAddress,
        SVR_DBName AS dbCatalogName,
        SVR_User AS dbUserID,
        SVR_Pass AS dbPassword,
        SVR_Port AS port,
        Login_Area AS areaCode,
        Login_Co AS areaName,
        Login_User AS userId,
        Login_Pass AS password,
        BA_Area_CODE AS lastAreaCode,
        BA_SW_CODE AS employeeCode,
        BA_SW_Name AS employeeName,
        AREA_ADDR AS areaAddress,
        AREA_DDD AS phoneAreaNumber,
        Sign_Folder AS signImagePath,
        License_Date AS licenseDate,
        Login_StartDate AS joinDate,
        Login_LastDate AS lastLoginDate,
        Login_EndDate AS expiryDate,
        APP_Cert AS menuPermission,
        Login_info AS individualNotice,
        Login_Memo AS remark,
        APP_PG_TYPE AS gasType
        FROM
        $catalogName$.dbo.AppUser
        WHERE 1=1
        <isNotEmpty prepend="AND " property="userId">Login_User = '$userId$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="password">Login_Pass = '$password$'</isNotEmpty>


    </select>


    <select id="GASMAX.AppUser.Select_userIdPwdUUid" resultClass="java.util.HashMap">
        SELECT
        HP_Number AS macNumber,
        CAST(HP_SEQ AS VARCHAR(2)) AS areaSeq,
        HP_State AS grantState,
        HP_Model AS phoneModel,
        HP_SNO AS mobileNumber,
        SVR_IP AS ipAddress,
        SVR_DBName AS dbCatalogName,
        SVR_User AS dbUserID,
        SVR_Pass AS dbPassword,
        SVR_Port AS port,
        Login_Area AS areaCode,
        Login_Co AS areaName,
        Login_User AS userId,
        Login_Pass AS password,
        BA_Area_CODE AS lastAreaCode,
        BA_SW_CODE AS employeeCode,
        BA_SW_Name AS employeeName,
        AREA_ADDR AS areaAddress,
        AREA_DDD AS phoneAreaNumber,
        Sign_Folder AS signImagePath,
        License_Date AS licenseDate,
        Login_StartDate AS joinDate,
        Login_LastDate AS lastLoginDate,
        Login_EndDate AS expiryDate,
        APP_Cert AS menuPermission,
        Login_info AS individualNotice,
        Login_Memo AS remark,
        APP_PG_TYPE AS gasType
        FROM
        $catalogName$.dbo.AppUser
        WHERE 1=1
        <isNotEmpty prepend="AND " property="userId">Login_User = '$userId$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="password">Login_Pass = '$password$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="uuid">HP_Number = '$uuid$'</isNotEmpty>
    </select>

    <select id="GASMAX.AppUser.Select_userIdPwdUUid_areaCode" resultClass="java.util.HashMap">
        SELECT
        HP_Number AS macNumber,
        CAST(HP_SEQ AS VARCHAR(2)) AS areaSeq,
        HP_State AS grantState,
        HP_Model AS phoneModel,
        HP_SNO AS mobileNumber,
        SVR_IP AS ipAddress,
        SVR_DBName AS dbCatalogName,
        SVR_User AS dbUserID,
        SVR_Pass AS dbPassword,
        SVR_Port AS port,
        Login_Area AS areaCode,
        Login_Co AS areaName,
        Login_User AS userId,
        Login_Pass AS password,
        BA_Area_CODE AS lastAreaCode,
        BA_SW_CODE AS employeeCode,
        BA_SW_Name AS employeeName,
        AREA_ADDR AS areaAddress,
        AREA_DDD AS phoneAreaNumber,
        Sign_Folder AS signImagePath,
        License_Date AS licenseDate,
        Login_StartDate AS joinDate,
        Login_LastDate AS lastLoginDate,
        Login_EndDate AS expiryDate,
        APP_Cert AS menuPermission,
        Login_info AS individualNotice,
        Login_Memo AS remark,
        APP_PG_TYPE AS gasType
        FROM
        $catalogName$.dbo.AppUser
        WHERE 1=1
        <isNotEmpty prepend="AND " property="userId">Login_User = '$userId$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="password">Login_Pass = '$password$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="uuid">HP_Number = '$uuid$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="areaCode">Login_Area = '$areaCode$'</isNotEmpty>
    </select>

    <select id="GASMAX.AppUser.Select_userIdPwdUUid_hpSeq" resultClass="java.util.HashMap">
        SELECT
        HP_Number AS macNumber,
        CAST(HP_SEQ AS VARCHAR(2)) AS areaSeq,
        HP_State AS grantState,
        HP_Model AS phoneModel,
        HP_SNO AS mobileNumber,
        SVR_IP AS ipAddress,
        SVR_DBName AS dbCatalogName,
        SVR_User AS dbUserID,
        SVR_Pass AS dbPassword,
        SVR_Port AS port,
        Login_Area AS areaCode,
        Login_Co AS areaName,
        Login_User AS userId,
        Login_Pass AS password,
        BA_Area_CODE AS lastAreaCode,
        BA_SW_CODE AS employeeCode,
        BA_SW_Name AS employeeName,
        AREA_ADDR AS areaAddress,
        AREA_DDD AS phoneAreaNumber,
        Sign_Folder AS signImagePath,
        License_Date AS licenseDate,
        Login_StartDate AS joinDate,
        Login_LastDate AS lastLoginDate,
        Login_EndDate AS expiryDate,
        APP_Cert AS menuPermission,
        Login_info AS individualNotice,
        Login_Memo AS remark,
        APP_PG_TYPE AS gasType
        FROM
        $catalogName$.dbo.AppUser
        WHERE 1=1
        <isNotEmpty prepend="AND " property="userId">Login_User = '$userId$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="password">Login_Pass = '$password$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="uuid">HP_Number = '$uuid$'</isNotEmpty>
        <isNotEmpty prepend="AND " property="hpSeq">HP_SEQ = '$hpSeq$'</isNotEmpty>
    </select>


    <select id="GASMAX.MultiAppUser.Select" resultClass="java.util.HashMap">
        SELECT
        HP_Number AS macNumber
        , CAST(HP_SEQ AS VARCHAR(2)) AS areaSeq
        , HP_State AS grantState
        , HP_Model AS phoneModel
        , HP_SNO AS mobileNumber
        , SVR_IP AS ipAddress
        , SVR_DBName AS dbCatalogName
        , SVR_User AS dbUserID
        , SVR_Pass AS dbPassword
        , SVR_Port AS port
        , Login_Area AS areaCode
        , Login_Co AS areaName
        , Login_User AS userId
        , Login_Pass AS password
        , BA_Area_CODE AS lastAreaCode
        , BA_SW_CODE AS employeeCode
        , BA_SW_Name AS employeeName
        , AREA_ADDR AS areaAddress
        , AREA_DDD AS phoneAreaNumber
        , Sign_Folder AS signImagePath
        , License_Date AS licenseDate
        , Login_StartDate AS joinDate
        , Login_LastDate AS lastLoginDate
        , Login_EndDate AS expiryDate
        , APP_Cert AS menuPermission
        , Login_info AS individualNotice
        , Login_Memo AS remark
        , APP_PG_TYPE AS gasType
        FROM
        $catalogName$.dbo.AppUser
        WHERE HP_State = 'Y'
        <isNotEmpty prepend="AND " property="macNumber">HP_Number = '$macNumber$'</isNotEmpty>
        -- ORDER BY HP_SEQ
    </select>


    <select id="GASMAX.AppUser.Select.AreaCode" resultClass="java.util.HashMap">
        SELECT AREA_CODE AS areaCode
             , AREA_NAME AS areaName
        FROM $catalogName$.dbo.JNOTRY
        WHERE 1 = 1
    </select>

    <select id="GASMAX.AppUser.Select.PhoneAreaNumber" resultClass="java.util.HashMap">
        SELECT Code     AS phoneAreaNumber
             , CodeName AS phoneAreaName
        FROM $catalogName$.dbo.BA_Code
        WHERE Gubun = 'DDD'
    </select>


    <parameterMap id="GASMAX.AppUser.Insert.ParameterValue" class="java.util.HashMap">
        <parameter property="macNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="phoneModel" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="mobileNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="areaName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="employeeName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="userId" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="password" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="phoneAreaNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="outputMessage" javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>


    <resultMap id="GASMAX.AppUser.Insert.ReturnValue" class="java.util.HashMap">
        <result property="outputMessage" column="@po_TRAN_INFO" jdbcType="VARCHAR"/>
    </resultMap>

    <procedure id="GASMAX.AppUser.Insert" resultMap="GASMAX.AppUser.Insert.ReturnValue" parameterMap="GASMAX.AppUser.Insert.ParameterValue">
        <![CDATA[
	  {
		   CALL GasMax_App.dbo.sp_AppUser (
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?
			)
		}
	   ]]>
    </procedure>
    <insert id="GASMAX.AppUser.Insert2" parameterClass="java.util.HashMap">
        INSERT INTO GasMax_App.dbo.AppUser (
            HP_Number,
            HP_Model,
            BA_SW_Name,
            Login_User,
            Login_Pass,
            AREA_DDD,
            Login_Area,
            Login_Co,
            HP_State
        ) VALUES (
                     #macNumber#,
                     #phoneModel#,
                     #employeeName#,
                     #userId#,
                     #password#,
                     #phoneAreaNumber#,
                     #areaCode#,
                     #areaName#,
                     'N'
                 )
    </insert>


    <!--todo:마지막 유저 정보 update-->
    <!--todo:마지막 유저 정보 update-->
    <!--todo:마지막 유저 정보 update-->
    <update id="GASMAX.AppUser.UpdateLatestLoginDate" parameterClass="java.util.HashMap">
        UPDATE GasMax_App.dbo.AppUser
        SET Login_LastDate = convert(varchar(16), GetDate(), 121)
        WHERE HP_Number = '$macNumber$'
        AND HP_State = 'Y'
        <isNotEmpty prepend="AND " property="areaSeq">HP_SEQ = '$areaSeq$'</isNotEmpty>
    </update>

    <update id="GASMAX.AppUser.Update" parameterClass="java.util.HashMap">
        UPDATE GasMax_App.dbo.AppUser
        SET
        Login_Area = '$areaCode$'
        , Login_Co = '$areaName$'
        , BA_SW_CODE = '$employeeCode$'
        , BA_SW_Name = '$employeeName$'
        , AREA_DDD = '$phoneAreaNumber$'
        , AREA_ADDR = '$address$'
        , Login_User = '$userId$'
        , Login_Pass = '$password$'
        , APP_Cert = '$menuPermission$'
        , APP_PG_TYPE = '$gasType$'
        WHERE HP_Number = '$macNumber$'
        AND HP_State = 'Y'
        AND HP_SEQ = '$areaSeq$'
    </update>
</sqlMap>
