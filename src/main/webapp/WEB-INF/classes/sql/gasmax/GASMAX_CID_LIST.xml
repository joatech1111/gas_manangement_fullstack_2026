<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
       PUBLIC 
             "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
              "http://ibatis.apache.org/dtd/sql-map-2.dtd"
 >
 
 <sqlMap>

     <select id="GASMAX.CidList.Select" resultClass="java.util.HashMap">
		SELECT
			  CID.Area_Code         AS areaCode
			, CID.CID_Date          AS cidDate
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_Date_Sno, 0),1),'.00','')      AS sequenceNumber
			, CID.CID_Time          AS cidTime
			, CID.CID_AutoGubun     AS autoRegisterType
			, CID.CID_Tel           AS phoneNumber
			, CID.CID_Sale_TYPE     AS saleTypeCode
			, CID.CID_Sale_Name     AS saleTypeName
			, CID.CID_CU_Code       AS customerCode
			, CID.CID_CU_Name       AS customerName
			, CID.CID_JP_Code       AS itemCode
			, CID.CID_JP_Name       AS itemName
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_QTY, 0),1),'.00','')           AS saleQuantity
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_REQTY, 0),1),'.00','')         AS withdrawQuantity
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_JP_Danga, 0),1),'.00','')      AS cidPrice
			, CID.CID_VAT_Div AS vatType
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_Kum_Sup, 0),1),'.000000','')        AS cidAmount
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_Kum_Vat, 0),1),'.000000','')        AS taxAmount
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_Kumack, 0),1),'.00','')        AS totalAmount
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_DC, 0),1),'.00','')            AS discountAmount
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_INKum, 0),1),'.00','')         AS collectAmount
			, REPLACE(CONVERT(VARCHAR(15), ISNULL(CID.CID_MisuKum, 0),1),'.00','')       AS unpaidAmount
			, CID.CID_SW_Code       AS employeeCode
			, CID.CID_SW_Name       AS employeeName
			, CID.CID_Bigo          AS remark
			, CONVERT(VARCHAR(1), CID.CID_OK_YN)         AS deliveryYesNo
			, CONVERT(VARCHAR(1), CID.CID_INKum_YN)      AS completeYesNo
			, CID.CID_InType AS collectType
			, CID.CU_ADDR          AS address
			, CUST.CU_TYPE AS customerType
		FROM $catalogName$.dbo.fn_RCVCID_LIST('$areaCode$','$cidDate$','$employeeCode$') CID
				LEFT OUTER JOIN CUSTOMER CUST ON 
							CID.Area_Code = CUST.Area_Code
					AND  CID.CID_CU_CODE = CUST.CU_CODE
		WHERE 1=1
			<isNotEmpty prepend="AND" property="onlyNew" > CID.CID_OK_YN = 0 </isNotEmpty>
			<isNotEmpty prepend="AND" property="onlyDelivered" > CID.CID_OK_YN = 1 AND CID.CID_INKum_YN = 0 </isNotEmpty>
			<isNotEmpty prepend="AND" property="onlyDeliveryComplete" > CID.CID_INKum_YN = 1 </isNotEmpty>
			<isNotEmpty prepend="AND" property="newAndDeilvered" > CID.CID_INKum_YN = 0 </isNotEmpty>
			<isNotEmpty prepend="AND" property="DeilveredAndDeliveryComplete" > CID.CID_OK_YN = 1 </isNotEmpty>
			<isNotEmpty prepend="AND" property="noEmployee" >  ISNULL(CID.CID_SW_Code, '') = ''  </isNotEmpty>
		ORDER BY CID.Area_Code, CID.CID_Date, CID.CID_Date_Sno DESC
	</select>
	
	<parameterMap id="GASMAX.CidList.Insert.ParameterValue" class="java.util.HashMap">
		<parameter property="areaCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="cidDate" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="saleType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="customerCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="customerName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="phoneNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="itemCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="itemName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="saleQuantity" javaType="java.lang.Integer" jdbcType="INTEGER" mode="IN" />
		<parameter property="withdrawQuantity" javaType="java.lang.Integer" jdbcType="INTEGER" mode="IN" />
		<parameter property="salePrice" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="priceType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="vatType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="saleAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="taxAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="totalAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="discountAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="collectAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="unpaidAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="employeeCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="employeeName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="remark" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="deliveryYesNo" javaType="java.lang.Boolean" jdbcType="BIT" mode="IN" />
		<parameter property="completeYesNo" javaType="java.lang.Boolean" jdbcType="BIT" mode="IN" />
		<parameter property="collectType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="registerDate" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="mobileNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="gasType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="sequenceNumber"       javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT" />
	</parameterMap>
     
	<resultMap id="GASMAX.CidList.Insert.ReturnValue" class="java.util.HashMap">
		<result property="outputMessage" column="@po_ERROR_CODE" jdbcType="VARCHAR"/>
		<result property="sequenceNumber" column="@po_CID_Date_Sno" jdbcType="INTEGER"/>
	</resultMap>

     <procedure id="GASMAX.CidList.Insert" resultMap="GASMAX.CidList.Insert.ReturnValue" parameterMap="GASMAX.CidList.Insert.ParameterValue">
	  <![CDATA[
	  {
		   CALL $catalogName$.dbo.sp_RCVCID (
				  ?
				, ?
				, ''
				, 'I'
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
			)
		}
	   ]]>
	 </procedure>
	 
	<parameterMap id="GASMAX.CidList.Update.ParameterValue" class="java.util.HashMap">
		<parameter property="areaCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="cidDate" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="sequenceNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="saleType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="customerCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="customerName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="phoneNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="itemCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="itemName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="saleQuantity" javaType="java.lang.Integer" jdbcType="INTEGER" mode="IN" />
		<parameter property="withdrawQuantity" javaType="java.lang.Integer" jdbcType="INTEGER" mode="IN" />
		<parameter property="salePrice" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="priceType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="vatType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="saleAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="taxAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="totalAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="discountAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="collectAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="unpaidAmount" javaType="java.lang.Float" jdbcType="FLOAT" mode="IN" />
		<parameter property="employeeCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="employeeName" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="remark" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="deliveryYesNo" javaType="java.lang.Boolean" jdbcType="BIT" mode="IN" />
		<parameter property="completeYesNo" javaType="java.lang.Boolean" jdbcType="BIT" mode="IN" />
		<parameter property="collectType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="registerDate" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="mobileNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="gasType" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="outputMessage"       javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT" />
	</parameterMap>

     
	<resultMap id="GASMAX.CidList.Update.ReturnValue" class="java.util.HashMap">
		<result property="outputMessage" column="@po_ERROR_CODE" jdbcType="VARCHAR"/>
	</resultMap>

     <procedure id="GASMAX.CidList.Update" resultMap="GASMAX.CidList.Update.ReturnValue" parameterMap="GASMAX.CidList.Update.ParameterValue">
	  <![CDATA[
	  {
		   CALL $catalogName$.dbo.sp_RCVCID (
				  ?
				, ?
				, ?
				, 'U'
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
			)
		}
	   ]]>
	 </procedure>
	 
	<parameterMap id="GASMAX.CidList.Delete.ParameterValue" class="java.util.HashMap">
		<parameter property="areaCode" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="cidDate" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
		<parameter property="sequenceNumber" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="outputMessage"       javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT" />
	</parameterMap>

     
	<resultMap id="GASMAX.CidList.Delete.ReturnValue" class="java.util.HashMap">
		<result property="outputMessage" column="@po_ERROR_CODE" jdbcType="VARCHAR"/>
	</resultMap>

     <procedure id="GASMAX.CidList.Delete" resultMap="GASMAX.CidList.Delete.ReturnValue" parameterMap="GASMAX.CidList.Delete.ParameterValue">
	  <![CDATA[
	  {
		   CALL $catalogName$.dbo.sp_RCVCID (
				  ?
				, ?
				, ?
				, 'D'
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ''
				, ?
			)
		}
	   ]]>
	 </procedure>
	 
    <select id="GASMAX.CidList.Select.SaleType" resultClass="java.util.HashMap">
		SELECT 
			  Code AS saleTypeCode
			, CodeName AS saleTypeName
		  FROM $catalogName$.dbo.BA_Code 
		WHERE Gubun = 'CID'
	</select>
	 
</sqlMap>