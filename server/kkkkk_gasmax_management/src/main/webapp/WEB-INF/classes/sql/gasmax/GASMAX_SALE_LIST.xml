<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
       PUBLIC 
             "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
              "http://ibatis.apache.org/dtd/sql-map-2.dtd"
 >
 
 <sqlMap>

     <select id="GASMAX.SaleList.Select" resultClass="java.util.HashMap">
			SELECT
				  Sale_Type    AS   saleType
				, AREA_CODE    AS   areaCode
				, PJ_Date      AS   saleDate
				, PJ_Sno       AS   sequenceNumber
				, PJ_CU_Code   AS   customerCode
				, PJ_CU_Name   AS   customerName
				, ISNULL(PJ_CU_Site, '')   AS   remark
				, JP_Name      AS   itemName
				
				, REPLACE(CAST(ISNULL(PJ_QTY,0) AS CHAR(15))  ,'.00','')           AS saleQuantity
				, REPLACE(CAST(ISNULL(PJ_REQTY,0) AS CHAR(15))  ,'.00','')         AS withdrawQuantity
				, REPLACE(CAST(ISNULL(PJ_REQTY_SIL,0) AS CHAR(15))  ,'.00','')         AS containerWithdrawQuantity
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_VAT_Div, 0), 1),'.00','')   AS   vatType
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_Danga, 0), 1),'.00','')     AS   salePrice
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_Kum_Sup, 0), 1),'.00','')   AS   supplyAmount
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_Kum_Vat, 0), 1),'.00','')   AS   taxAmount
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_Kumack, 0), 1),'.00','')    AS   saleAmount
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_DC, 0), 1),'.00','')        AS   discountAmount
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_INKum, 0), 1),'.00','')     AS   collectAmount
				, REPLACE(CONVERT(VARCHAR(15), ISNULL(PJ_MISUKUM, 0), 1),'.00','')   AS   unpaidAmount
				, PJ_SW_Code   AS   employeeCode
				, PJ_SW_Name   AS   employeeName
				, PJ_InKumType AS   collectType
			FROM $catalogName$.dbo.fn_SALE_LIST('$areaCode$', '$employeeCode$', '$keyword$', '$startDate$', '$endDate$')
			WHERE 1=1
			<isNotEmpty prepend="AND" property="saleType"> Sale_Type = '$saleType$' </isNotEmpty>
			<isNotEmpty prepend="AND" property="collectTypeCode_0">( PJ_InKumType = '0' OR PJ_InKumType = 'B') </isNotEmpty>
			<isNotEmpty prepend="AND" property="collectTypeCode"> PJ_InKumType = '$collectTypeCode$' </isNotEmpty>
			<isNotEmpty prepend="AND" property="noEmployee"> PJ_SW_NAME IS NULL </isNotEmpty>
			ORDER BY PJ_Date DESC, PJ_CU_Name ASC
	</select>
	
</sqlMap>